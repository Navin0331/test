<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-menu/paper-submenu.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">


<dom-module id="login-input">

    <link rel="import" type="css" href="../custom_components/custom.css">

    <template>
        <paper-header-panel style="margin:-8px;" class="main" main mode="tall">
            <paper-toolbar>

                <div>Login</div>
            </paper-toolbar>
            <div class="content">
                <paper-material>
                    <div class="container">
                        <paper-input label="Username" type="text" value="{{userName}}"></paper-input>
                        <paper-input label="Password" type="password" value="{{passWord}}"></paper-input>
                        <paper-button on-tap="login">Login</paper-button>
                        <paper-button on-tap="">Reset</paper-button>
                    </div>


                </paper-material>

            </div>

        </paper-header-panel>


    </template>

    <script>
        Polymer({
            if(sessionStorage.getItem("token")){
            // when have token
        }else{
                // when no token
                }

            is: 'login-input',
            properties: {
                userName: {
                    type: String,
                    notify: true
                },
                passWord: {
                    type: String,
                    notify: true
                }
            },
            login: function (e) {
                var ajax = document.querySelector("#ajax")
                ajax.method = "POST"
                ajax.contentType = "application/x-www-form-urlencoded"
                ajax.body = {
                    "username": this.userName,
                    "password": this.passWord
                }
                ajax.url = "http://localhost:8080/api/auth/login"
                var req = ajax.generateRequest()
                req.completes.then(function (v) {
                    console.log(v.response)
                    sessionStorage.setItem('token', v.response.token);
                    window.location.href = "user/admin"
                   
                }, function (e) {
                    console.log(e)
                })
            },
            reset: function(a){
                
            }
        });
    </script>

</dom-module>